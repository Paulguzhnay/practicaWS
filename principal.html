<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Webv Socket Imprimir</title>
</head>
<body style="background-color: blue;">
    <form>
    <input type="button" value="Conectar Servidor" onclick="connect()" />
    <br>
    <br>
    <label for="fname"><h1>Texto a Imprimir:</h1></label>
    <br>
    <br>
    <input type="text" id="textI" >
    <br>
    <br>
    
<br>
<br>

<input style="background-color: yellow;" type="button" value="Imprimir" onclick="sendFile()" />
</form>





<script>
    var ws;

    function connect() {
        ws = new WebSocket("ws://localhost:8025/websockets/receive/fileserver");
        ws.binaryType = "arraybuffer";
        ws.onopen = function() {
            alert("Servidor Conectado")
        };

        ws.onmessage = function(evt) {
            alert(evt.msg);
        };

        ws.onclose = function() {
            alert("Conexion Cerrada");
        };
        ws.onerror = function(e) {
            alert(e.msg);
        }

    }

    function sendFile() {
        var file = document.getElementById('textI');
        console.log(file.value)
        ws.send(file.value)
        alert('IMPRIMIENDO...')

        /*ws.send('filename:'+file.name);
        var reader = new FileReader();
        var rawData = new ArrayBuffer();
        reader.loadend = function() {}
        reader.onload = function(e) {
            rawData = e.target.result;
            ws.send(rawData);
            alert("file transferred.")
            ws.send('end');
        }*/
        //reader.readAsArrayBuffer(file);
    }


</script>
</body>
</html>